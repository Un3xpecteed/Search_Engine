# Simple Async Search Engine

Это простой асинхронный поисковый движок, построенный с использованием FastAPI, SQLAlchemy (async) и Redis. Он позволяет загружать текстовые документы и выполнять поиск по их содержимому с использованием TF-IDF для ранжирования результатов.

## Особенности

*   **Загрузка файлов:** Загрузка текстовых файлов через API (`POST /upload/`).
*   **Поиск:** Поиск по содержимому загруженных документов (`GET /search/`).
*   **Асинхронность:** Использует `asyncio`, асинхронные драйверы SQLAlchemy (`aiosqlite`) и Redis (`redis-py`).
*   **Кеширование:** Результаты поиска кешируются в Redis для ускорения повторных запросов.
*   **Ранжирование:** Использует базовую реализацию TF-IDF для оценки релевантности документов.
*   **База данных:** Хранит информацию о документах и инвертированный индекс в базе данных SQLite.

## Технологии

*   Python 3.10+
*   FastAPI
*   SQLAlchemy (с `aiosqlite`)
*   Redis (с `redis-py` async)
*   Uvicorn (ASGI сервер)
*   Pydantic

## Установка и Запуск

1.  **Клонируйте репозиторий:**
    ```bash
    git clone <your-repo-url>
    cd <your-repo-directory>
    ```

2.  **Установите зависимости:**
    (Предполагается использование `uv` из-за `uv.lock`, но можно адаптировать под `pip`)
    ```bash
    # Если у вас нет uv: pip install uv
    uv sync
    ```
    *Или, если бы был requirements.txt:*
    ```bash
    # pip install -r requirements.txt
    ```

3.  **Запустите Redis:**
    Убедитесь, что сервер Redis запущен и доступен по адресу `redis://localhost:6379` (или измените URL в `app/search_engine.py`).
    ```bash
    # Пример запуска Redis с использованием Docker:
    docker run -d -p 6379:6379 redis
    ```

4.  **База данных:**
    База данных SQLite (`search_engine.db`) будет создана в корне проекта при первом запуске, если ее нет. Таблицы должны быть созданы автоматически SQLAlchemy (требуется проверка, может потребоваться скрипт инициализации или запуск с созданием таблиц). *Примечание: В текущем коде нет явного создания таблиц при старте. Возможно, потребуется добавить логику для `Base.metadata.create_all(bind=engine)` при запуске или выполнить это вручную.*

5.  **Запустите приложение:**
    ```bash
    uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
    ```
    Приложение будет доступно по адресу `http://localhost:8000`.

## API Эндпоинты

*   **`POST /upload/`**:
    *   Загружает текстовый файл.
    *   Ожидает `multipart/form-data` с полем `file`.
    *   Пример использования с `curl`:
        ```bash
        curl -X POST -F "file=@./test_data/testfastapi3.txt" http://localhost:8000/upload/
        ```

*   **`GET /search/`**:
    *   Выполняет поиск по загруженным документам.
    *   Принимает параметр `query`.
    *   Пример использования с `curl`:
        ```bash
        curl "http://localhost:8000/search/?query=fastapi+python"
        ```
    *   Возвращает JSON-список с объектами `{ "name": "...", "score": ... }`.

## Тестирование

Для запуска тестов (если они настроены):
```bash
pytest
Use code with caution.
Markdown
(Предполагается, что pytest установлен как зависимость).
Этот README охватывает основные аспекты проекта, необходимые для понимания его назначения и запуска.
Use code with caution.
